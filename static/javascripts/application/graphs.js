// Generated by CoffeeScript 1.8.0
(function() {
  var aspect, chart;

  $(function() {
    var area, h, line, svg, w, x, y;
    console.log('wat');
    h = 108;
    w = ($('.js-correlations-header-graph')).width();
    x = d3.scale.linear().range([0, w]);
    y = d3.scale.linear().range([h, 0]);
    line = d3.svg.line().interpolate('basis').x(function(d) {
      return x(d.index);
    }).y(function(d) {
      return y(d.identifier);
    });
    area = d3.svg.area().interpolate('cardinal').x(function(d) {
      return x(d.index);
    }).y0(h).y1(function(d) {
      return y(d.identifier);
    });
    svg = d3.select('.js-correlations-header-graph').append('svg').attr('id', 'svg-chart').attr('viewbox', '0 0 960' + h).attr('preserveAspectRatio', 'xMinYMid').attr('width', w).attr('height', h);
    return d3.json(($('.js-correlations-header-graph')).attr('data-url'), function(data) {
      x.domain(d3.extent(data, function(d) {
        return d.index;
      }));
      y.domain([
        0, d3.max(data, function(d) {
          return d.identifier;
        })
      ]);
      data.forEach(function(d) {
        d.identifier = d.identifier;
        return d.index = d.index;
      });
      svg.append('path').datum(data).attr('class', 'area').attr('d', area);
      return svg.append('path').datum(data).attr('class', 'line').attr('d', line);
    });
  });

  aspect = ($('.js-correlations-header-graph')).width() / 108;

  chart = $('#svg-chart');

  ($(window)).on('resize', function() {
    var targetWidth;
    targetWidth = ($('.js-correlations-header-graph')).width();
    chart.attr('width', targetWidth);
    return chart.attr('height', targetWidth / aspect);
  });

}).call(this);
