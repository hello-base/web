{% extends "layouts/site_base.html" %}
{% load music_tags %}
{% load typogrify_tags %}

{% block title %}{{ object.romanized_name }} ({{ object.name }}){% endblock %}
{% block meta %}
<link rel="canonical" href="{{ request.build_absolute_uri }}">
{% endblock %}
{% block content %}
<section class="profile idol-profile" itemscope itemtype="http://schema.org/Person">
  <meta content="{{ object.get_absolute_url }}" itemprop="url">

  <div class="profile-masthead"></div>
  <header class="profile-header">
    <div class="container">
      <div class="profile-metadata">
        <div class="profile-photo"></div>
        <h1 class="profile-name">
          <span class="name"><b>{{ object.family_name }}</b>{{ object.given_name }}</span>
          <span class="romanized-name" itemprop="name"><b>{{ object.romanized_family_name }}</b> {{ object.romanized_given_name }}</span>
          {% with object.primary_membership as primary %}<p class="standing"><span itemprop="jobTitle">{{ primary.standing }}</span>{% if primary.group.romanized_name != "Soloist" %} of <span itemprop="affiliation">{{ primary.group }}</span>{% endif %}</p>{% endwith %}
        </h1>
      </div>
    </div>
  </header>

  <div class="profile-content">
    <section class="participations">
      <div class="container">
        {# <h2 class="section-title">Contributions to Hello! Project</h2> #}
        <ul class="participation-list">
          <li class="participation group-participation">
            <div class="statistic">
              <h3 class="participation-type"><span class="ss-icon ss-usergroup"></span> <span>Groups</span></h3>
              <span class="count">{{ object.memberships.count }}</span>
            </div>
            <div class="participation-latest">
            {% with object.primary_membership as primary %}
              <div class="latest-heading"><span class="pill">Main Group</span></div>
              <a href="{{ primary.group.get_absolute_url }}">{{ primary.group }}</a>
              <div class="subtext">
                <time datetime="{{ primary.started|date:"c" }}/{% if primary.ended %}{{ primary.ended|date:"c" }}{% else %}{% now "c" %}{% endif %}">
                  Member {% if primary.is_active %}
                    since <b>{{ primary.started|date:"F j, Y" }}</b>
                  {% else %}
                    from <b>{{ primary.started|date:"F j, Y" }}</b>&ndash;<b>{{ primary.ended|date:"F j, Y" }}</b>
                  {% endif %}
                </time>
                {% if primary.is_leader %}
                <time datetime="{{ primary.leadership_started|date:"c" }}/{% if primary.leadership_ended %}{{ primary.leadership_ended|date:"c" }}{% else %}{% now "c" %}{% endif %}">
                  and leader {% if not primary.leadership_ended %}
                    since <b>{{ primary.leadership_started|date:"F j, Y" }}</b>
                  {% else %}
                    from <b>{{ primary.leadership_started|date:"F j, Y"}}</b>&ndash;<b>{{ primary.leadership_ended|date:"F j, Y" }}</b>
                  {% endif %}
                </time>
              {% endif %}
              </div>
            {% endwith %}
            </div>
          </li><!-- .group-participation -->
          <li class="participation single-participation">
            <div class="statistic">
              <h3 class="participation-type"><span class="ss-icon ss-music"></span> <span>Singles</span></h3>
              <span class="count">{{ singles|length }}</span>
            </div>
            <div class="participation-latest">
              {% with object.latest_single as release %}
              <div class="latest-heading"><span class="pill">{% if object.primary_membership.is_active %}Latest{% else %}Last{% endif %}</span></div>
              <a href="{{ release.get_absolute_url }}">{{ release }}</a>
              <div class="subtext">
                <div class="release-data release-date">
                  <time datetime="{{ release.released|date:"c" }}"><span class="ss-icon ss-calendar"></span> <b>{{ release.released|date }}</b></time>
                  <time datetime="{{ release.released|date:"c" }}/{% now "c" %}" class="timesince">({{ release.released|timesince }} ago)</time>
                </div>
                <div class="release-data release-editions">
                  <span class="ss-icon ss-disc"></span> <b>{{ release.editions.count }}</b> edition{{ release.editions.count|pluralize }}
                </div>
              </div>
              {% endwith %}
            </div>
          </li><!-- .single-participation -->
          <li class="participation album-participation">
            <div class="statistic">
              <h3 class="participation-type"><span class="ss-icon ss-music"></span> <span>Albums</span></h3>
              <span class="count">{{ albums|length }}</span>
            </div>
            <div class="participation-latest">
              {% with object.latest_album as release %}
              <div class="latest-heading"><span class="pill">{% if object.primary_membership.is_active %}Latest{% else %}Last{% endif %}</span></div>
              <a href="{{ release.get_absolute_url }}">{{ release }}</a>
              <div class="subtext">
                <div class="release-data release-date">
                  <time datetime="{{ release.released|date:"c" }}"><span class="ss-icon ss-calendar"></span> <b>{{ release.released|date }}</b></time>
                  <time datetime="{{ release.released|date:"c" }}/{% now "c" %}" class="timesince">({{ release.released|timesince }} ago)</time>
                </div>
                <div class="release-data release-editions">
                  <span class="ss-icon ss-disc"></span> <b>{{ release.editions.count }}</b> edition{{ release.editions.count|pluralize }}
                </div>
              </div>
              {% endwith %}
            </div>
          </li><!-- .album-participation -->
          <li class="participation event-participation">
            <div class="statistic">
              <h3 class="participation-type"><span class="ss-icon ss-mic"></span> <span>Events</span></h3>
              <span class="count">{{ events|length }}</span>
            </div>
            <div class="participation-latest">
              {% with object.latest_event as event %}
              <div class="latest-heading"><span class="pill">{% if object.primary_membership.is_active %}Latest{% else %}Last{% endif %}</span></div>
              <a href="{{ event.get_absolute_url }}">{{ event }}</a>
              <div class="subtext">
                {{ event.start_date|date }}
                {# Released <time datetime="{{ album.released|date:"c" }}">{{ album.released|date }}</time> ({{ album.released|timesince }} ago) in {{ album.editions.count }} edition{{ album.editions.count|pluralize }} #}

              </div>
              {% endwith %}
            </div>
          </li><!-- .event-participation -->
        </ul><!-- .participation-list -->
      </div><!-- .container -->
    </div><!-- .participations -->



    <div class="container">
      <aside class="profile-vitals">
        <ul class="vitals-list">
          <li class="vital vital-age"><span class="ss-icon ss-exercise"></span> {% firstof object.age "Unknown" %} <span class="vital-label">Age</span></li>
          <li class="vital vital-birthday"><span class="ss-icon ss-calendar"></span> <time datetime="{{ object.birthdate|date:"c" }}" itemprop="birthDate">{% firstof object.birthdate|date:"F j, Y" "Unknown" %}</time> <span class="vital-label">Birthday</span></li>
          <li class="vital vital-bloodtype"><span class="ss-icon ss-anatomicalheart"></span> {% firstof object.bloodtype "Unknown" %} <span class="vital-label">Bloodtype</span></li>
          <li class="vital vital-height"><span class="ss-icon ss-tapemeasure"></span> {% firstof object.height "Unknown" %}{% if object.height %}cm{% endif %} <span class="vital-label">Height</span></li>
        </ul>
      </aside>
      <div class="latest-releases">
        <div class="release">
        {% with object.latest_single as release %}
          <div class="pill-container"><span class="pill">Latest Single</span></div>
          {% include "people/partials/shared_releases_music_latest.html" with release=release %}
        {% endwith %}
        </div>
        <div class="release">
        {% with object.latest_album as release %}
          <div class="pill-container"><span class="pill">Latest Album</span></div>
          {% include "people/partials/shared_releases_music_latest.html" with release=release %}
        {% endwith %}
        </div>
      </div>
    </div>
  </header>

<section class="memberships">
  <div class="container">
    {% with object.primary_membership as primary %}
    <div class="membership-primary">
      <div class="membership-section-title"><span class="pill">Primary Focus</span></div>
      <div class="group-image">
        <div class="empty-image"><span class="ss-icon ss-usergroup"></span></div>
      </div><!-- .group-image -->
      <div class="group-metadata">
        <span class="name">{{ primary.group.name }}</span>
        <a href="{{ primary.group.get_absolute_url }}"><span class="romanized-name">{{ primary.group }}</span></a>
        <span class="tenure">
          <time datetime="{{ primary.started|date:"c" }}/{% if primary.ended %}{{ primary.ended|date:"c" }}{% else %}{% now "c" %}{% endif %}">
            {{ primary.started }}&ndash;{% if primary.ended %}{{ primary.ended }}{% else %}Present{% endif %}
          </time>
          <span class="tenure in-days">({{ primary.tenure_in_days }} days)</span>
        </span>
      </div><!-- .group-metadata -->
    </div><!-- .membership-primary -->
    {% endwith %}
    {% if memberships %}
    <div class="membership-secondary">
      <div class="membership-section-title"><span class="pill">Other Groups</span></div>
      <ul class="membership-list">
      {% for membership in memberships %}
        <li class="membership">
          <div class="group-image">
            <div class="empty-image"></div>
          </div><!-- .group-image -->
          <span class="name">{{ membership.group.name }}</span>
          <a href="{{ membership.group.get_absolute_url }}"><span class="romanized-name">{{ membership.group }}</span></a>
          <span class="tenure">
            <time datetime="{{ membership.started|date:"c" }}/{% if membership.ended %}{{ membership.ended|date:"c" }}{% else %}{% now "c" %}{% endif %}">
              {{ membership.started }}&ndash;{% if membership.ended %}{{ membership.ended }}{% else %}Present{% endif %}
            </time>
            <span class="tenure in-days">({{ membership.tenure_in_days }} days)</span>
          </span>
        </li><!-- .membership -->
      {% endfor %}
      </ul><!-- .membership-list -->
    </div><!-- .membership-secondary -->
    {% else %}
    {# @TODO: Empty state. #}
    {% endif %}
  </div><!-- .container -->
</section><!-- .memberships -->

<section class="releases">
  <div class="container">
    <div class="releases-singles">
      <h2 class="section-title">Singles {{ singles|length }}</h2>
      <ul class="release-list">
      {% for release in singles %}
        <li class="release">
          <div class="release-image">
            <div class="empty-image"><span class="ss-icon ss-disc"></span></div>
          </div><!-- .release-image -->
          <div class="release-meta">
            <span class="name">{{ release.name }}</span>
            <a href="{{ release.get_absolute_url }}"><span class="romanized-name">{{ release.romanized_name|typogrify }}</span></a>
            <span class="release-participants">{% contextual_participants release=release idol=object %}</span>
            <div class="release-date"><time datetime="{{ release.released|date:"c" }}">{{ release.released|date }}</time> &middot; {{ release.editions.count }} edition{{ release.editions.count|pluralize }}</div>
          </div><!-- .release-meta -->
        </li><!-- .release -->
      {% endfor %}
      </ul><!-- .release-list -->
    </div><!-- .releases-singles -->
    <div class="releases-albums">
      <h2 class="section-title">Albums {{ albums|length }}</h2>
      <ul class="release-list">
      {% for release in albums %}
        <li class="release">
          <div class="release-image">
            <div class="empty-image"><span class="ss-icon ss-disc"></span></div>
          </div><!-- .release-image -->
          <div class="release-meta">
            <span class="name">{{ release.name }}</span>
            <a href="{{ release.get_absolute_url }}"><span class="romanized-name">{{ release.romanized_name|typogrify }}</span></a>
            <span class="release-participants">{% contextual_participants release=release idol=object %}</span>
            <div class="release-date"><time datetime="{{ release.released|date:"c" }}">{{ release.released|date }}</time> &middot; {{ release.editions.count }} edition{{ release.editions.count|pluralize }}</div>
          </div><!-- .release-meta -->
        </li><!-- .release -->
      {% endfor %}
      </ul><!-- .release-list -->
    </div><!-- .releases-albums -->
  </div><!-- .container -->
</section><!-- .releases -->

</section>

{% endblock content %}
