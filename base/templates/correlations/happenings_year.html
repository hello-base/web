{% extends "layouts/site_base.html" %}
{% load correlation_tags %}

{% block title %}{{ year|date:"Y" }} Happenings{% endblock %}
{% block body-class %}override{% endblock %}
{% block content %}
<section class="happenings happening-decade-{{ year|date:'Y'|slice:':3' }}0">
  <header class="override-header">
    <div class="container">
      <h1 class="happening-header"><span class="year">{{ year|date:"Y" }}</span> Happenings</h1>
    </div>
  </header>

  <div class="happening-navigation">
    <div class="container">
      {% if next_year %}
      <div class="previous-year">
        <a href="{% url 'happenings-by-year' next_year|date:'Y' %}"><span class="ss-icon ss-navigateleft"></span> {{ next_year|date:"Y" }}</a>
      </div>
      {% endif %}
      <div class="happening-decades">
        <header class="happening-decades-header">
          <a href="javascript:;" class="happening-toggle">
            <span class="ss-icon ss-calendar"></span>
            <h2>Other Years</h2>
            <span class="ss-icon ss-dropdown"></span>
          </a>
        </header>
        <ul class="happening-decade-list">
        {% for decade, values in years.items reversed %}
          <li class="{{ decade }}">
            <strong>{{ decade }}</strong>
            <ul class="happening-year-list">
            {% for value in values %}
              <li {% if year == value %}class="selected"{% endif %}>
                <a href="{% url 'happenings-by-year' value|date:'Y' %}">{{ value|date:"Y" }}</a>
              </li>
            {% endfor %}
            </ul>
          </li>
        {% endfor %}
        </ul>
      </div>
      {% if previous_year %}
      <div class="next-year">
        <a href="{% url 'happenings-by-year' previous_year|date:'Y' %}">{{ previous_year|date:"Y" }} <span class="ss-icon ss-navigateright"></span></a>
      </div>
      {% endif %}
    </div>
  </div>

  <div class="container">
    <ul>
    {% for date in date_list %}
      <li><a href="#{{ date|date:"F"|lower }}">{{ date|date:"F" }}</a></li>
    {% endfor %}
    </ul>

    {% regroup object_list by timestamp.month as month_list %}
    <ul>
    {% for month in month_list reversed %}
      <li id="{{ month.grouper|month_name|lower }}">{{ month.grouper|month_name }}
        <ul>
        {% for item in month.list %}
          <li>
            {{ item.timestamp|date:"jS" }}
            {% with item.content_object as object %}
            <a href="{{ object.get_absolute_url }}">{{ object }}</a>
            {% endwith %}
          </li>
        {% endfor %}
        </ul>
      </li>
    {% endfor %}
    </ul>
  </div>
</section>
{% endblock content %}
